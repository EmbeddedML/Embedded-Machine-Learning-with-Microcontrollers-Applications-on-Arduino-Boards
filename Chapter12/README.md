# Chapter 12 - EMBEDDING THE NEURAL NETWORK MODEL TO THE MICROCONTROLLER

## ABout This Chapter

We introduced the TensorFlow platform and fundamentals of neural networks in previous chapters. It is time to embed the trained neural network models to the microcontroller. To do so, we will benefit from TensorFlow Lite as the specialized version of TensorFlow for embedded systems (including microcontrollers). Hence, we will start with its properties. Then, we will show ways of converting TensorFlow and Keras models to TensorFlow Lite format. Model conversion is not sufficient alone to embed the model on a microcontroller. The main reason is the size of TensorFlow Lite model. In other words, the model should be optimized beforehand since microcontrollers have limited flash and RAM size. Therefore, we will cover model optimization via quantization, pruning, and weight clustering. Operations to be performed up to this point will be done on PC. The next step is embedding the final TensorFlow Lite model to the microcontroller. Hence, we will consider necessary steps to be followed for this purpose. Embedding the trained neural network model to the microcontroller can also be done by the STM32Cube.AI platform. We will cover it to provide a second way of embedding a TensorFlow or Keras model to the STM32 microcontroller. Throughout the chapter, we will reconsider the neural network models introduced in Chapter 11 and embed them to the microcontroller. We will also apply the same procedure to the end of chapter applications.

<!-- ## Listings
<center>

| Description  | Code    |
|----------------------------------------------------------------------------------- | ----------------------------------------------------------------- |
| Random number generation from one-dimensional Gaussian pdfs                        | [![Code](../Images/py.png)](PythonScripts/generate_normal.py)     |
| Random number generation from two-dimensional Gaussian pdfs                        | [![Code](../Images/py.png)](PythonScripts/clf_data_generation.py) |
| Random number generation for regression operations                                 | [![Code](../Images/py.png)](PythonScripts/reg_data_generation.py) |
| Random numbers generated by the STM32 microcontroller                              | [![Code](../Images/py.png)](PythonScripts/serial_read.py)         |
| Random number generation example on Mbed Studio                                    | [![Code](../Images/cpp.png)](mbed_serial.cpp)                     |
| Normalizing the two-dimensional random numbers by the min-max method               | [![Code](../Images/py.png)](PythonScripts/minmax_scaler.py)       |
| Normalizing the two-dimensional random numbers by the z-score normalization method | [![Code](../Images/py.png)](PythonScripts/standard_scaler.py)     |

</center>


## End of Chapter Applications

<center>

| Description                         | Python Scripts                                             |  Project Files                                        |
| ----------------------------------- | ---------------------------------------------------------- | ----------------------------------------------------- |
| Human Activity Recognition          | [![Code](../Images/py.png)](Application1-HAR/main.py)      | [![Code](../Images/stm32.png)](Application1-HAR/.ioc) |
| Keyword Spotting                    | [![Code](../Images/py.png)](Application2-KWS/mfcc_main.py) | [![Code](../Images/stm32.png)](Application1-HAR/.ioc) |
| Handwritten Digit Recognition       | [![Code](../Images/py.png)](Application3-HDR/mnist.py)     | [![Code](../Images/stm32.png)](Application3-HDR/.ioc) |

</center> -->

